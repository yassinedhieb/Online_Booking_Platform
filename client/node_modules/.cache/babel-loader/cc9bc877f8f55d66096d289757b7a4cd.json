{"ast":null,"code":"import axios from 'axios';\nimport { returnErrors } from './errorActions';\nimport { USER_LOADED, USER_LOADING, AUTH_ERROR, LOGIN_SUCCESS, LOGIN_FAIL, LOGOUT_SUCCESS, REGISTER_SUCCESS, REGISTER_FAIL } from './types'; //check token and load user\n\nexport const loadUser = () => (dispatch, getState) => {\n  //user loading\n  dispatch({\n    type: USER_LOADING\n  });\n  axios.get('/api/auth/user', tokenConfig(getState)).then(res => dispatch({\n    type: USER_LOADED,\n    payload: res.data\n  })).catch(err => {\n    dispatch(returnErrors(err.response.data, err.response.status));\n    dispatch({\n      type: AUTH_ERROR\n    });\n  });\n}; //Register User\n\nexport const register = ({\n  name,\n  last_name,\n  city,\n  email,\n  password\n}) => dispatch => {\n  //headers\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }; //request body\n\n  const body = JSON.stringify({\n    name,\n    last_name,\n    city,\n    email,\n    password\n  });\n  axios.post('/api/users', body, config).then(res => dispatch({\n    type: REGISTER_SUCCESS,\n    payload: res.data\n  })).catch(err => {\n    dispatch(returnErrors(err.response.data, err.response.status, 'REGISTER_FAIL'));\n    dispatch({\n      type: REGISTER_FAIL\n    });\n  });\n};\nexport const registerAdmin = ({\n  name,\n  last_name,\n  city,\n  email,\n  password,\n  role\n}) => dispatch => {\n  //headers\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }; //request body\n\n  const body = JSON.stringify({\n    name,\n    last_name,\n    city,\n    email,\n    password,\n    role\n  });\n  axios.post('/api/users', body, config).then(res => dispatch({\n    type: REGISTER_SUCCESS,\n    payload: res.data\n  })).catch(err => {\n    dispatch(returnErrors(err.response.data, err.response.status, 'REGISTER_FAIL'));\n    dispatch({\n      type: REGISTER_FAIL\n    });\n  });\n}; //login\n\nexport const login = ({\n  email,\n  password\n}) => dispatch => {\n  //headers\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }; //request body\n\n  const body = JSON.stringify({\n    email,\n    password\n  });\n  axios.post('/api/auth', body, config).then(res => dispatch({\n    type: LOGIN_SUCCESS,\n    payload: res.data\n  })).catch(err => {\n    dispatch(returnErrors(err.response.data, err.response.status, 'LOGIN_FAIL'));\n    dispatch({\n      type: LOGIN_FAIL\n    });\n  });\n}; //logout user\n\nexport const logout = () => {\n  return {\n    type: LOGOUT_SUCCESS\n  };\n}; //setup config/headers and token\n\nexport const tokenConfig = getState => {\n  //get token from localstorage\n  const token = getState().auth.token; //headers\n\n  const config = {\n    headers: {\n      \"content-type\": \"application/json\"\n    }\n  }; //if token=>add t headers\n\n  if (token) {\n    config.headers['x-auth-token'] = token;\n  }\n\n  return config;\n};","map":{"version":3,"sources":["C:/Users/Yassine/Desktop/project/PROJECT/Project1/client/src/actions/authActions.js"],"names":["axios","returnErrors","USER_LOADED","USER_LOADING","AUTH_ERROR","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT_SUCCESS","REGISTER_SUCCESS","REGISTER_FAIL","loadUser","dispatch","getState","type","get","tokenConfig","then","res","payload","data","catch","err","response","status","register","name","last_name","city","email","password","config","headers","body","JSON","stringify","post","registerAdmin","role","login","logout","token","auth"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport {returnErrors} from './errorActions'\n\nimport {\n    USER_LOADED,\n    USER_LOADING,\n    AUTH_ERROR,\n    LOGIN_SUCCESS,\n    LOGIN_FAIL,\n    LOGOUT_SUCCESS,\n    REGISTER_SUCCESS,\n    REGISTER_FAIL\n} from './types'\n\n//check token and load user\nexport const loadUser=()=>(dispatch,getState)=>{\n    //user loading\n    dispatch({\n        type:USER_LOADING\n    });\n    axios\n    .get('/api/auth/user',tokenConfig(getState))\n    .then(res=>dispatch({\n        type:USER_LOADED,\n        payload:res.data\n    }))\n    .catch(err=>{\n        dispatch(returnErrors(err.response.data,err.response.status))\n        dispatch({\n            type:AUTH_ERROR\n        });\n    })\n}\n//Register User\n\nexport const register=({name,last_name,city,email,password})=>dispatch=>{\n    //headers\n    const config={\n        headers:{\n            'Content-Type':'application/json'\n        }\n    }\n    //request body\n    const body =JSON.stringify({\n        name,last_name,city,email,password\n    })\n    axios.post('/api/users',body, config)\n    .then(res=>dispatch({\n        type:REGISTER_SUCCESS,\n        payload:res.data\n    }))\n    .catch(err=>{\n         dispatch(returnErrors(err.response.data,err.response.status,'REGISTER_FAIL'));\n         dispatch({\n             type:REGISTER_FAIL\n         });\n     });\n};\nexport const registerAdmin=({name,last_name,city,email,password,role})=>dispatch=>{\n    //headers\n    const config={\n        headers:{\n            'Content-Type':'application/json'\n        }\n    }\n    //request body\n    const body =JSON.stringify({\n        name,last_name,city,email,password,role\n    })\n    axios.post('/api/users',body, config)\n    .then(res=>dispatch({\n        type:REGISTER_SUCCESS,\n        payload:res.data\n    }))\n    .catch(err=>{\n         dispatch(returnErrors(err.response.data,err.response.status,'REGISTER_FAIL'));\n         dispatch({\n             type:REGISTER_FAIL\n         });\n     });\n};\n//login\nexport const login=({email,password})=>dispatch=>{\n    //headers\n    const config={\n        headers:{\n            'Content-Type':'application/json'\n        }\n    }\n    //request body\n    const body =JSON.stringify({\n        email,password\n    })\n    axios.post('/api/auth',body, config)\n    .then(res=>dispatch({\n        type:LOGIN_SUCCESS,\n        payload:res.data\n    }))\n    .catch(err=>{\n         dispatch(returnErrors(err.response.data,err.response.status,'LOGIN_FAIL'));\n         dispatch({\n             type:LOGIN_FAIL\n         });\n     });\n};\n//logout user\nexport const logout =()=>{\n    return {\n        type:LOGOUT_SUCCESS\n    }\n}\n\n//setup config/headers and token\nexport const tokenConfig=(getState)=>{\n    //get token from localstorage\n    const token=getState().auth.token;\n    //headers\n    const config={\n        headers:{\n            \"content-type\":\"application/json\"\n        }\n    }\n\n    //if token=>add t headers\n    if(token){\n        config.headers['x-auth-token']=token;\n    }\n    return config;\n}"]},"metadata":{},"sourceType":"module"}